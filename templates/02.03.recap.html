{% extends "00.base.html" %}
{% block title %}Recap{% endblock %}

{% block content %}
<div class="main-content">
    <h1 class="heading">Recap</h1>
    <p class="caption">Weekly Recap of Taehyung and Jung Kook!</p>

    <div class="upcoming-container">        
        {% if recaps %}
        <div class="weekly-recap-section">
            <h2 class="section-heading">ðŸŒŸ Weekly Recap ðŸŒŸ</h2>
            <div class="recap-cards">

                {% for recap in recaps %}
                <div class="recap-card">
                    <h3 class="recap-title">{{ recap.title.replace("Week of ", "Week of<br>") | safe }}</h3>

                    {% set video_url = recap.video %}

                    {# -------------------------------
                       YOUTUBE (normal + shorts)
                       ------------------------------- #}
                    {% if "youtube.com" in video_url or "youtu.be" in video_url %}
                        {% set yt_id = video_url.split("/")[-1].split("?")[0] %}
                        <iframe width="100%" height="250"
                                src="https://www.youtube.com/embed/{{ yt_id }}"
                                frameborder="0" allowfullscreen>
                        </iframe>

                    {# -------------------------------
                       TIKTOK
                       ------------------------------- #}
                    {% elif "tiktok.com" in video_url %}
                        <blockquote class="tiktok-embed" cite="{{ video_url }}">
                            <section></section>
                        </blockquote>
                        <script async src="https://www.tiktok.com/embed.js"></script>

                    {# -------------------------------
                       INSTAGRAM
                       ------------------------------- #}
                    {% elif "instagram.com" in video_url %}
                        <blockquote 
                            class="instagram-media"
                            data-instgrm-permalink="{{ video_url }}"
                            data-instgrm-version="14">
                        </blockquote>
                        <script async src="//www.instagram.com/embed.js"></script>

                    {# -------------------------------
                       TWITTER / X
                       ------------------------------- #}
                    {% elif "twitter.com" in video_url or "x.com" in video_url %}
                        <blockquote class="twitter-video">
                            <a href="{{ video_url }}"></a>
                        </blockquote>
                        <script async src="https://platform.twitter.com/widgets.js"></script>

                    {# -------------------------------
                       FALLBACK: LOCAL MP4 FILE
                       ------------------------------- #}
                    {% else %}
                        <video class="recap-video" controls controlsList="nodownload">
                            <source src="{{ url_for('static', video='images/recap/' + video_url) }}" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    {% endif %}
                </div>
                {% endfor %}

            </div>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
